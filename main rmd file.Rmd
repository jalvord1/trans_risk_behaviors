---
title: "main r file"
author: "Julianna Alvord"
date: "2/13/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### This should remain the same for everyone
```{r}
library(dplyr)
library(mosaic)
library(ggplot2)
library(stats)

#can't upload file because too large
#need to select vars

#vars selected and data filtered in other rmd (data download.Rmd)

filtered_data <- read.csv("Pop Health Data 2016.csv")
```

###Julianna
```{r}
#Starting data analysis 2-14

#Creating new vars------------------------

#Transgender
filtered_data <- filtered_data %>%
  filter(!trnsgndr %in% c(7,9)) %>%
  mutate(transgender = ifelse(trnsgndr == 1, "female", 
                              ifelse(trnsgndr == 2, "male", 
                                     ifelse(trnsgndr == 3, "non-conforming", "Cis"))))

#High HIV risk binary variable 
filtered_data <- filtered_data %>%
  filter(!is.na(hivrisk4)) %>%
  filter(!hivrisk4 %in% c(7, 9)) %>%
  mutate(high_hiv_risk = ifelse(hivrisk4 == 1, 1, 0))

#Race (grouped) 
filtered_data <- filtered_data %>%
  filter(!x.racegr3 == 9) %>%
  mutate(race = ifelse(x.racegr3 == 1, "white", 
                       ifelse(x.racegr3 == 2, "black", 
                              ifelse(x.racegr3 == 3, "other", 
                                     ifelse(x.racegr3 == 4, "multi", "hispanic")))))

#Descriptive Stats-----------------------
tally(filtered_data$transgender)
tally(filtered_data$high_hiv_risk)


#Models-----------------------------------

#Initial Model
logm1 <- glm(high_hiv_risk ~ transgender, data = filtered_data, family = binomial)
summary(logm1)

exp(cbind(OR = coef(logm1)))

#Adding race var
filtered_data$race <- as.factor(filtered_data$race)
filtered_data$race <- relevel(filtered_data$race, ref = "white")

logm2 <- glm(high_hiv_risk ~ transgender + race, data = filtered_data, family = binomial)
summary(logm2)

exp(cbind(OR = coef(logm2)))


#Interaction var (trans:race) 
logm_int <- glm(high_hiv_risk ~ transgender + race + transgender*race, data = filtered_data, family = binomial)
summary(logm_int)

exp(cbind(OR = coef(logm_int)))

#Are the interaction terms compared to transgender:white or cis:white?
```

###Natalie
```{r}
ggplot(aes(x=myass, y=git), data="lithub")
```

###Raegan
```{r}
Starting data analysis 2-14
```

###Cas
```{r}
#Starting data analysis 2/14
```




